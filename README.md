# Analysis of Factors Affecting Relative Crop Yields in No-Till vs. Conventional Tillage Systems

**A Capstone Project for Data Science and Analytics Course 503: Design of Experiments**
**SUNY Polytechnic Institute**

Henry Zelenak
May 2025

## Project Overview

This project investigates the environmental and management factors that influence the relative yield performance of no-tillage (NT) agricultural systems compared to conventional tillage (CT) systems. The analysis focuses on maize, winter wheat, and soybean production within the United States and Mexico, utilizing a subset of the global dataset compiled by Su et al. (2021).

The primary research question addressed is:
*What environmental factors (soil texture, precipitation, average temperature) and management practices (irrigation, complex crop rotation, years under no-tillage), along with crop type and site country, significantly influence the Relative Yield Change (RYC) between no-tillage and conventional tillage systems?*

Statistical modeling, primarily Robust Linear Models (RLM), was employed to analyze the `log1p`-transformed RYC, accounting for data transformations and exploring interactions between key predictors.

## Key Findings

The analysis revealed several significant factors influencing the relative performance of NT systems:

1. **Soil Texture and Temperature Interaction:** A significant interaction was found where, on Sandy Loam soils, warmer average temperatures tended to *improve* NT's relative performance, while on Loam soils, temperature had a less clear effect.
2. **Crop Rotation:** Implementing a complex crop rotation (>= 3 crops) significantly *improved* the relative performance of NT.
3. **Precipitation:** Higher precipitation was associated with a *decrease* in NT's relative performance.
4. **Crop Type:** Winter wheat showed significantly *better* relative performance under NT compared to maize (the reference crop). Soybeans did not differ significantly from maize in this regard.
5. **Site Country:** Experiments in the USA reported significantly *better* relative NT performance compared to Mexico, after controlling for other factors.
6. Irrigation and the duration of NT adoption did not show robust, significant effects in the final interaction model.

These findings highlight the context-dependent nature of NT performance and emphasize the importance of considering soil-climate interactions and specific management practices.

## Dataset

The analysis uses data derived from:
Su, Y., Gabrielle, B. & Makowski, D. A global dataset for crop production under conventional tillage and no tillage systems. Sci Data 8, 33 (2021). <https://doi.org/10.1038/s41597-021-00817-x>
The original dataset can be accessed via figshare: <https://doi.org/10.6084/m9.figshare.12155553.v14>

The specific subset used for the final modeling (`NA_M_WW_clean.csv`) is a result of preprocessing and cleaning steps detailed in the accompanying Jupyter Notebook/Python script and research report. This cleaned dataset focuses on maize, winter wheat, and soybean in the USA and Mexico and includes selected predictors after outlier removal and transformation.

## Project Structure

The project is organized as follows:

* **`README.md`**: This file, providing an overview of the project.
* **`Tillage_analysis.ipynb`**: The main Jupyter Notebook or Python script containing all data loading, preprocessing, exploratory data analysis, statistical modeling, and visualization code, as well as the report content.
  * *Note: The notebook/script should be self-contained, with all necessary code and comments to understand the analysis steps.*
* **`data/`**: Directory containing the data files.
  * `Database.csv`: The original global dataset from Su et al. (2021).
  * `NA_M_WW_clean.csv`: The cleaned and subsetted data file used for the final modeling steps.
* **`requirements.txt`**: Lists the Python package dependencies for this project.
* **`requirements-lock.txt`**: A more specific lock file for dependencies, often generated by tools like Rye or Poetry.
* **`.gitignore`**: Standard git ignore file (e.g., for Python environments, IDE files, etc.).
* **`pyproject.toml`**: Configuration file for the Rye environment (or Poetry, if used directly).

## Technical Setup

This project was developed using Python within a **Rye** managed environment.

### Prerequisites

* [Rye](https://rye-up.com/) installed on your system.
* Python (Rye will typically manage the Python version specified in `pyproject.toml`).

### Setting up the Environment

1. **Clone the repository:**

    ```bash
    git clone [URL_to_your_repository]
    cd [repository_name]
    ```

2. **Initialize the Rye environment and install dependencies:**
    Rye uses the `pyproject.toml` file to manage the project and its dependencies. The `requirements.txt` and `requirements-lock.txt` files further specify these dependencies.

    ```bash
    rye sync
    ```

    This command will:
    * Create a virtual environment (usually in `.venv` within the project directory).
    * Install the Python interpreter version specified in `pyproject.toml` (if not already available).
    * Install all the packages listed in `requirements.txt` (or resolved from `pyproject.toml` and `requirements-lock.txt`).

### Running the Analysis

1. **Activate the Rye environment (optional but good practice if running scripts directly):**
    Rye commands often automatically run within the project's environment. If you need to activate it manually for your shell session:

    ```bash
    source .venv/bin/activate 
    # On Windows: .venv\Scripts\activate
    ```

    Alternatively, prefix commands with `rye run`:

    ```bash
    rye run python [Your_Script_Name].py
    ```

    Or, to start a Jupyter Notebook/Lab session:

    ```bash
    rye run jupyter notebook
    # or
    rye run jupyter lab
    ```

2. **Execute the Jupyter Notebook or Python script:**
    Open and run the cells in `[Your_Notebook_Name].ipynb` using Jupyter Lab or Jupyter Notebook.
    If it's a `.py` script, run it from the terminal:

    ```bash
    python [Your_Script_Name].py
    ```

### Key Python Libraries Used

* **pandas**: For data manipulation and analysis.
* **numpy**: For numerical operations.
* **statsmodels**: For statistical modeling (OLS, RLM, VIF).
* **scipy**: For statistical tests (e.g., Shapiro-Wilk).
* **matplotlib & seaborn**: For static data visualizations.
* **plotly**: For interactive data visualizations.
* **patsy**: For creating design matrices from formulas (used by statsmodels).

(Ensure these are listed in your `requirements.txt` and `pyproject.toml` under dependencies).

## Methodological Summary

1. **Data Source:** Su et al. (2021) global dataset.
2. **Subset Selection:** Focused on maize, winter wheat, and soybean in the USA and Mexico.
3. **Data Cleaning:** Handled missing values, duplicates, and outliers (initial flagging by Su et al. and further identified outliers based on Z-scores and boxplots). Categorical variables like irrigation and crop rotation were consolidated based on paired experimental design.
4. **Response Variable:** `Relative Yield Change (RYC) = (Yield_NT - Yield_CT) / Yield_CT`. This was transformed using `log1p(RYC)` (denoted as `logp_ryc`) to improve its distributional properties for modeling.
5. **Predictor Variables:**
    * Quantitative: Years since NT started (log1p-transformed), Precipitation (original scale), Average Temperature (original scale, also centered for interaction terms).
    * Categorical: Soil Texture (ST), Irrigation, Crop Rotation (>=3 crops), Crop Type, Site Country.
6. **Modeling:**
    * Initial Ordinary Least Squares (OLS) regression was performed.
    * Residual diagnostics (Shapiro-Wilk for normality, Breusch-Pagan for homoscedasticity, visual plots) indicated violations of OLS assumptions.
    * Robust Linear Models (RLM with Huber's T norm) were subsequently used for more reliable inference.
    * Multicollinearity was assessed using Variance Inflation Factors (VIFs).
    * An interaction term between Soil Texture and (centered) Average Temperature was investigated based on the principle of heredity and theoretical interest.

## Contact

Henry Zelenak - <https://www.linkedin.com/in/henry-zelenak/> | <https://henryzelenak.com>
